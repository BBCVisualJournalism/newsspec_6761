(function(){var g;var d=false;var i;gloader.load(["glow","1","glow.dom","glow.events","glow.widgets","glow.widgets.Panel","glow.net","glow.anim"],{async:true,onLoad:function(m){g=m;g.ready(l)}});function l(){var o=g.dom.get("#loading");var p=g.dom.get("#latest_casualties");o.hide();p.show();var r=g.dom.get("#mil_cas_selector input");g.events.addListener(r,"click",h);var q=g.dom.get(".facewall li");g.events.addListener(q,"click",j);f("loc_afghanistan");var n=g.dom.get("#navBar");if(g.env.ie){g.dom.get("#navBar").css("margin-left","20px")}new c("#navBar",{});var m="afghanistan";r.each(function(){g.dom.get(this)[0].checked=false});switch(m){case"afghanistan":g.dom.get("#loc_afghanistan")[0].checked=true;g.events.fire("#loc_afghanistan","click");break;case"iraq":g.dom.get("#loc_iraq")[0].checked=true;g.events.fire("#loc_iraq","click");break;default:g.dom.get("#loc_afghanistan")[0].checked=true;g.events.fire("#loc_afghanistan","click");break}}function j(m){if(d==true){i.hide()}var u=g.dom.get(m.attachedTo);var n=u.get("img").attr("title");var s=u.get("dl").clone();s.attr("class","panel_details");var o=u.get("a").clone();var t=g.dom.create('<div id="simplePanel">');var v=g.dom.create('<h2 class="hd">'+n+"</h2>");var q=u.get("img").attr("src");var p=q.replace("/59","/170").replace("_59","_170");var r=g.dom.create("<img>").attr("src",p);var w=g.dom.create('<div class="bd">');w.append(r);w.append(s);var x=g.dom.create('<div class="ft">');x.append(o);t.append(v).append(w).append(x);i=new g.widgets.Panel(t,{theme:"light",width:450,modal:false});i.show();d=true}function b(o,p,m,r){var q=o*m;var n=q+m;if(n>=g.dom.get(p).length){p.slice(q).show();f(r)}else{p.slice(q,n).show();setTimeout(function(){b(++o,p,m,r)},70)}}function k(o,p,m,r){var q=o*m;var n=q+m;if(n>=g.dom.get(p).length){p.slice(q).hide();f(r)}else{p.slice(q,n).hide();setTimeout(function(){k(++o,p,m,r)},70)}}function h(m){var n=g.dom.get(m.attachedTo).attr("id");if(n=="loc_afghanistan"){k(0,g.dom.get(".iraq"),100,n);b(0,g.dom.get(".afghanistan"),100,n)}else{if(n=="loc_iraq"){k(0,g.dom.get(".afghanistan"),100,n);b(0,g.dom.get(".iraq"),100,n)}else{b(0,g.dom.get(".afghanistan"),100,n);b(0,g.dom.get(".iraq"),100,n)}}}function f(o){var m=o.substring(4);g.dom.get("#navBar").html("<h3>Fatalities by year</h3>");var n="<li class='ukcas-navbar-"+m+"' style='display:block;'></li>";g.dom.get(".year").each(function(q){var p=0;var s="";var r=g.dom.get(this).get(".yearSpan").html();g.dom.get("#navBar").append("<div class='ukcas-nav-collection' id='block"+q+"'></div>");g.dom.get("#navBar").get("#block"+q).append("<a href='#y"+r+"'>"+r+"</a>").append("<ul></ul>");g.dom.get(this).get("li").each(function(t){if(g.dom.get(this).css("display")!="none"){s+=n;p++}});g.dom.get("#navBar").get("#block"+q).get("ul").append(s);g.dom.get(this).get("h2").get(".deathCount").html(p+"")});g.dom.get("#navBar").append("<h5>Go to top</h5>");g.events.addListener(g.dom.get("#navBar").get("h5"),"click",a)}function a(){window.scrollTo(0,0)}function c(p,o){var p=g.dom.get(p);var m=p.css("position");function n(){var r=parseInt(g.dom.get(window).height());var t=parseInt(g.dom.get(window).scrollTop());var u=parseInt(p.cont.offset().top);var s=parseInt(p.cont.item(0).offsetHeight);var v=parseInt(p.item(0).offsetHeight+(parseInt(p.css("margin-top"))||0)+(parseInt(p.css("margin-bottom"))||0));var q;o.offset=0;if(parseInt(p.initialOffsetTop)>=(t+o.offset)){q=parseInt(p.initialTop)}else{q=Math.min((Math.max((-u),(t-parseInt(p.initialOffsetTop)+parseInt(p.initialTop)))+o.offset),(s-v-p.paddingAdjustment))}o.delay=0;if((new Date().getTime()-p.lastScroll)>=(o.delay-20)){g.anim.css(p,0.2,{top:q}).start()}}p.cont=g.dom.get("#latest_casualties");p.initialTop=parseInt(p.css("top"))||0;p.initialOffsetTop=parseInt(p.offset().top);if(p.css("position")=="relative"){p.paddingAdjustment=parseInt(p.cont.css("paddingTop"))+parseInt(p.cont.css("paddingBottom"))}else{p.paddingAdjustment=0}window.onscroll=function(){e.interval=setTimeout(function(){n()},0);p.lastScroll=new Date().getTime()};window.onresize=function(){e.interval=setTimeout(function(){n()},o.delay);p.lastScroll=new Date().getTime()};p.lastScroll=0;n()}var e=function(m){m=m||{};m.speed=m.speed||500;m.offset=m.offset||0;m.delay=m.delay||0;this.each(function(){new c(this,m)});return this}})();